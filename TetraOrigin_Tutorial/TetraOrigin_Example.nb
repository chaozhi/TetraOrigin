(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     57028,       1277]
NotebookOptionsPosition[     53869,       1177]
NotebookOutlinePosition[     54789,       1206]
CellTagsIndexPosition[     54623,       1200]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\<D:\\\\Chaozhi\\\\GitHub Clones\\\\TetraOrigin\\\\TetraOrigin_Packages\
\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<TetraOrigin`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6107820227481675`*^9, 3.6107820266181674`*^9}, {
  3.6107820695581675`*^9, 3.6107820697781677`*^9}, {3.6112138163372493`*^9, 
  3.6112138265872493`*^9}, {3.6263416646303277`*^9, 3.6263416651703277`*^9}, {
  3.6263552508829355`*^9, 3.626355251711983*^9}, {3.63074661488214*^9, 
  3.6307466336021404`*^9}, {3.662883924541039*^9, 3.662883930469006*^9}, {
  3.662981309391464*^9, 3.6629813104795732`*^9}, {3.6629814210126257`*^9, 
  3.6629814214426684`*^9}, {3.664521309789481*^9, 3.664521319711335*^9}, {
  3.6645216281784067`*^9, 3.664521630190832*^9}}],

Cell[BoxData["\<\"D:\\\\Chaozhi\\\\GitHub \
Clones\\\\TetraOrigin\\\\TetraOrigin_Tutorial\"\>"], "Output",
 CellChangeTimes->{{3.6629813110126266`*^9, 3.6629813245679817`*^9}, {
   3.6629814120957336`*^9, 3.662981421791703*^9}, 3.6645211983417625`*^9, 
   3.664521632094057*^9, 3.667656730455365*^9, 3.6726531857403655`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataid", "=", "\"\<simSNPDose\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SNPDosefile", "=", "\"\<simSNPDose.csv\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"chrsubset", ",", "snpsubset"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"\"\<All\>\"", ",", "\"\<All\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsF", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eps", "=", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"-", "3."}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ploidy", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outputid", "=", "dataid"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6307441873861403`*^9, 3.63074423202614*^9}, {
   3.6307442837061405`*^9, 3.63074428956614*^9}, {3.6307444584261403`*^9, 
   3.6307444645961404`*^9}, {3.6307445095461407`*^9, 
   3.6307445130461407`*^9}, {3.6307449925171404`*^9, 3.6307449927071404`*^9}, 
   3.63074849002614*^9, {3.645246254325859*^9, 3.645246256844859*^9}, {
   3.645246433266859*^9, 3.6452464334418592`*^9}, {3.6726531607963657`*^9, 
   3.6726531764213657`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SNPDose", "=", 
   RowBox[{"Import", "[", "SNPDosefile", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "SNPDose", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SNPDose", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", "10"}], ",", 
     RowBox[{";;", "10"}]}], "]"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6198577197428646`*^9, 3.6198577339948645`*^9}, {
  3.620719064115803*^9, 3.6207190828089905`*^9}, {3.6216932652897425`*^9, 
  3.621693266665821*^9}, {3.6219194990674243`*^9, 3.62191949985744*^9}, {
  3.621920478374303*^9, 3.621920479554303*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"55", ",", "76"}], "}"}]], "Output",
 CellChangeTimes->{3.662981324699995*^9, 3.6629814121607404`*^9, 
  3.6645211984977636`*^9, 3.664521632250059*^9, 3.6676567305193977`*^9, 
  3.672653185910365*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"marker\"\>", "\<\"SNP1\"\>", "\<\"SNP2\"\>", "\<\"SNP3\"\>", \
"\<\"SNP4\"\>", "\<\"SNP5\"\>", "\<\"SNP6\"\>", "\<\"SNP7\"\>", \
"\<\"SNP8\"\>", "\<\"SNP9\"\>"},
     {"\<\"chromosome\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", \
"\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>"},
     {"\<\"position_cM\"\>", "0.1578`", "1.6068`", "3.8056`", "5.1862`", 
      "6.9518`", "7.9891`", "9.5328`", "11.9003`", "13.5111`"},
     {"\<\"parent1\"\>", "1", "2", "2", "0", "2", "1", "3", "3", "3"},
     {"\<\"parent2\"\>", "\<\"NA\"\>", "1", "2", "2", "2", "\<\"NA\"\>", "3", 
      "1", "2"},
     {"\<\"sib1\"\>", "\<\"NA\"\>", "1", "1", "2", "1", "2", "\<\"NA\"\>", 
      "2", "3"},
     {"\<\"sib2\"\>", "2", "2", "1", "1", "3", "1", "3", "2", "3"},
     {"\<\"sib3\"\>", "2", "2", "0", "1", "2", "2", "3", "3", "2"},
     {"\<\"sib4\"\>", "3", "2", "1", "1", "2", "3", "\<\"NA\"\>", "3", "2"},
     {"\<\"sib5\"\>", "3", "1", "2", "1", "2", "2", "4", "2", "4"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.662981324699995*^9, 3.6629814121607404`*^9, 
  3.6645211984977636`*^9, 3.664521632250059*^9, 3.6676567305193977`*^9, 
  3.672653185924365*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**"}], "*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**"}], "*", 
   RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}],
    "*", "*", "**"}], "******)"}]], "Input",
 CellChangeTimes->{{3.6214025021356735`*^9, 3.6214025084166737`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"??", "inferTetraOrigin"}]], "Input",
 CellChangeTimes->{{3.6566871409892616`*^9, 3.6566871419096737`*^9}, 
   3.6629814581493387`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"inferTetraOrigin[SNPDose, chrsubset, snpsubset, eps, \
founderhaplo, ploidy, outputid] calculates the posterior probabilities for \
each sib at each SNP marker given the the parental haplotype founderhaplo, \
and the results are saved in the file \
\\\"TetraOrigin_Output_outputid_LinkageGroupA.txt\\\" for the linkage group \
A, and so on for the rest linkage groups. Refer to inferTetraPhase for \
estimating parental haplotype and descriptions of other paremters. \
\\ninferTetraOrigin[SNPDose, chrsubset, snpsubset, eps, epsF, ploidy, \
outputid] is a combination of {founderhaplo, loglhistory}= \
inferTetraPhase[SNPDose, chrsubset, snpsubset, eps, epsF,ploidy] and \
inferTetraOrigin[SNPDose, chrsubset, snpsubset, eps, epsF,ploidy, \
founderhaplo, outputid].\"\>", "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.672653190172365*^9},
 CellTags->"Info-ae0a2cb4-a547-4811-b239-858c35d96cdf"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     RowBox[{
      RowBox[{"Attributes", "[", "inferTetraOrigin", "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"Protected", ",", "ReadProtected"}], "}"}]}]},
    {" "},
    {GridBox[{
       {
        RowBox[{
         RowBox[{"Options", "[", "inferTetraOrigin", "]"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"maxStuck", "\[Rule]", "10"}], ",", 
           RowBox[{"maxIteration", "\[Rule]", "100"}], ",", 
           RowBox[{"minRepeatRun", "\[Rule]", "3"}], ",", 
           RowBox[{"maxPhasingRun", "\[Rule]", "20"}], ",", 
           RowBox[{"bivalentPhasing", "\[Rule]", "True"}], ",", 
           RowBox[{"bivalentDecoding", "\[Rule]", "False"}]}], "}"}]}]}
      },
      BaselinePosition->{Baseline, {1, 1}},
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{"Columns" -> {{
           Scaled[0.999]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[TetraOrigin`inferTetraOrigin],
  Editable->False]], "Print",
 CellChangeTimes->{3.6726531901973653`*^9},
 CellTags->"Info-ae0a2cb4-a547-4811-b239-858c35d96cdf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"inferTetraOrigin", "[", 
   RowBox[{
   "SNPDosefile", ",", "chrsubset", ",", "snpsubset", ",", "eps", ",", "epsF",
     ",", "ploidy", ",", "outputid", ",", 
    RowBox[{"bivalentPhasing", "\[Rule]", "True"}], ",", 
    RowBox[{"bivalentDecoding", "\[Rule]", "False"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6272144384257183`*^9, 3.6272144577797184`*^9}, 
   3.6272145239327183`*^9, {3.627214677459198*^9, 3.62721468048044*^9}, {
   3.6307449992271404`*^9, 3.6307449998271403`*^9}, {3.6307452773291407`*^9, 
   3.6307452922691402`*^9}, {3.6307455266001406`*^9, 
   3.6307455324701405`*^9}, {3.6307457909101405`*^9, 
   3.6307457964201403`*^9}, {3.6307458862201405`*^9, 
   3.6307458868601403`*^9}, {3.6566870906786165`*^9, 
   3.6566870921138353`*^9}, {3.662981318539379*^9, 3.662981319768502*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Start Date =\"\>", 
   "\[InvisibleSpace]", "\<\"Thu 19 May 2016 15:27:48\"\>", 
   "\[InvisibleSpace]", "\<\". Chromosome  = \"\>", 
   "\[InvisibleSpace]", "\<\"A\"\>"}],
  SequenceForm[
  "Start Date =", "Thu 19 May 2016 15:27:48", ". Chromosome  = ", "A"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6629813250900345`*^9, 3.664521198840966*^9, 
  3.664521632593263*^9, 3.667656730662469*^9, 3.6726531904053655`*^9, 
  3.6726532680983653`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Finish Phasing Date =\"\>", 
   "\[InvisibleSpace]", "\<\"Thu 19 May 2016 15:29:07\"\>", 
   "\[InvisibleSpace]", "\<\". Time used in Phasing = \"\>", 
   "\[InvisibleSpace]", "79.80000000000001`", 
   "\[InvisibleSpace]", "\<\" Seconds. log posterior of phasing runs = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1744.65`"}], ",", 
     RowBox[{"-", "2029.22`"}], ",", 
     RowBox[{"-", "1744.65`"}], ",", 
     RowBox[{"-", "1744.65`"}]}], "}"}]}],
  SequenceForm[
  "Finish Phasing Date =", "Thu 19 May 2016 15:29:07", 
   ". Time used in Phasing = ", 79.80000000000001, 
   " Seconds. log posterior of phasing runs = ", {-1744.65, -2029.22, \
-1744.65, -1744.65}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6629813250900345`*^9, 3.664521198840966*^9, 
  3.664521632593263*^9, 3.667656730662469*^9, 3.6726531904053655`*^9, 
  3.6726533479023657`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Start Date =\"\>", 
   "\[InvisibleSpace]", "\<\"Thu 19 May 2016 15:29:07\"\>", 
   "\[InvisibleSpace]", "\<\". Outputfile=\"\>", 
   "\[InvisibleSpace]", \
"\<\"TetraOrigin_Output_simSNPDose_LinkageGroupA.txt\"\>"}],
  SequenceForm[
  "Start Date =", "Thu 19 May 2016 15:29:07", ". Outputfile=", 
   "TetraOrigin_Output_simSNPDose_LinkageGroupA.txt"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6629813250900345`*^9, 3.664521198840966*^9, 
  3.664521632593263*^9, 3.667656730662469*^9, 3.6726531904053655`*^9, 
  3.6726533479773655`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Finish Date =\"\>", 
   "\[InvisibleSpace]", "\<\"Thu 19 May 2016 15:29:29\"\>", 
   "\[InvisibleSpace]", "\<\". Time used in Posteriordecoding = \"\>", 
   "\[InvisibleSpace]", "21.3`", "\[InvisibleSpace]", "\<\" Seconds.\"\>"}],
  SequenceForm[
  "Finish Date =", "Thu 19 May 2016 15:29:29", 
   ". Time used in Posteriordecoding = ", 21.3, " Seconds."],
  Editable->False]], "Print",
 CellChangeTimes->{3.6629813250900345`*^9, 3.664521198840966*^9, 
  3.664521632593263*^9, 3.667656730662469*^9, 3.6726531904053655`*^9, 
  3.6726533693003654`*^9}],

Cell[BoxData["\<\"------------------------------------------------------------\
--------------------------\"\>"], "Print",
 CellChangeTimes->{3.6629813250900345`*^9, 3.664521198840966*^9, 
  3.664521632593263*^9, 3.667656730662469*^9, 3.6726531904053655`*^9, 
  3.672653369325365*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**"}], "*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**"}], "*", 
   RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}],
    "*", "*", "**"}], "******)"}]], "Input",
 CellChangeTimes->{{3.6214025021356735`*^9, 3.6214025084166737`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"linkagegroup", "=", "\"\<A\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"tetraResultFile", "=", 
  RowBox[{
  "\"\<TetraOrigin_Output_\>\"", "<>", "dataid", "<>", 
   "\"\<_LinkageGroup\>\"", "<>", 
   RowBox[{"ToString", "[", "linkagegroup", "]"}], "<>", 
   "\"\<.txt\>\""}]}], "\[IndentingNewLine]", 
 RowBox[{"summaryFile", "=", 
  RowBox[{"StringReplace", "[", 
   RowBox[{"tetraResultFile", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<.txt\>\"", "\[Rule]", "\"\<_Summary.csv\>\""}], "}"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6726534762225657`*^9, 3.6726534766593657`*^9}}],

Cell[BoxData["\<\"TetraOrigin_Output_simSNPDose_LinkageGroupA.txt\"\>"], \
"Output",
 CellChangeTimes->{{3.6726534567069654`*^9, 3.6726534770181656`*^9}}],

Cell[BoxData["\<\"TetraOrigin_Output_simSNPDose_LinkageGroupA_Summary.csv\"\>\
"], "Output",
 CellChangeTimes->{{3.6726534567069654`*^9, 3.6726534770337653`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FileExistsQ", "[", "tetraResultFile", "]"}]], "Input",
 CellChangeTimes->{{3.6726534583293657`*^9, 3.672653462946965*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6726534634617653`*^9, 3.6726534792021656`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"refhaploFile", "=", "\"\<trueParentPhase.csv\>\""}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"saveAsSummaryITO", "[", 
      RowBox[{"tetraResultFile", ",", "summaryFile"}], "]"}], ";"}], "//", 
    "AbsoluteTiming"}]}]}]], "Input",
 CellChangeTimes->{
  3.626783596427175*^9, 3.626784015301175*^9, 3.626784062210175*^9, 
   3.626784898302175*^9, {3.62679935630717*^9, 3.6267993567871704`*^9}, 
   3.62679945629731*^9, {3.626856360392397*^9, 3.626856367913322*^9}, {
   3.6268564825928497`*^9, 3.6268564828028493`*^9}, 3.627023008697693*^9, 
   3.6270249634357543`*^9, {3.627025045114117*^9, 3.627025054256209*^9}, {
   3.6307444177161407`*^9, 3.6307444511261406`*^9}, {3.6452464177238593`*^9, 
   3.6452464221708593`*^9}, {3.6726534549753656`*^9, 
   3.6726534992637653`*^9}, {3.6726535972409654`*^9, 3.6726535974281654`*^9}}],

Cell[BoxData["\<\"trueParentPhase.csv\"\>"], "Output",
 CellChangeTimes->{3.6629813725437794`*^9, 3.6645212946102915`*^9, 
  3.6645216642268715`*^9, 3.6676567995962086`*^9, 3.6726532580603657`*^9, 
  3.6726535039281654`*^9, 3.6726535981769657`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.554335151764496`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.6629813725437794`*^9, 3.6645212946102915`*^9, 
  3.6645216642268715`*^9, 3.6676567995962086`*^9, 3.6726532580603657`*^9, 
  3.6726535039281654`*^9, 3.672653603730565*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**"}], "*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**"}], "*", 
   RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}],
    "*", "*", "**"}], "******)"}]], "Input",
 CellChangeTimes->{{3.6214025021356735`*^9, 3.6214025084166737`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "getSummaryITO"}]], "Input",
 CellChangeTimes->{{3.6452464616158595`*^9, 3.6452464621758595`*^9}}],

Cell[BoxData[
 StyleBox["\<\"getSummaryITO[summaryFile] imports the summary produced by \
saveAsSummaryITO for furthur analysis in mathematica, and returns \
{description, snpmap, esthaplo, refhaplo, logllist, siblogl, genotypes, \
estgenoprob, esthaploprob}, where description is a list of explainations for \
the rest.\"\>", "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.6726532617203655`*^9},
 CellTags->"Info-13a38cde-892c-44f5-9d92-8ee02e570cbc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "description", ",", "snpmap", ",", "esthaplo", ",", "refhaplo", ",", 
      "logllist", ",", "siblogl", ",", "genotypes", ",", "estgenoprob", ",", 
      "esthaploprob"}], "}"}], "=", 
    RowBox[{"getSummaryITO", "[", "summaryFile", "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dimensions", "[", "#", "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{
   "description", ",", "snpmap", ",", "esthaplo", ",", "refhaplo", ",", 
    "logllist", ",", "siblogl", ",", "genotypes", ",", "estgenoprob", ",", 
    "esthaploprob"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"description", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"esthaplo", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"3", ";;"}], ",", 
     RowBox[{"2", ";;"}]}], "]"}], "]"}], "==", 
  RowBox[{"refhaplo", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"3", ";;"}], ",", 
     RowBox[{"2", ";;"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6268018680146866`*^9, 3.626801889544717*^9}, {
   3.6271065524283524`*^9, 3.6271065554384127`*^9}, 3.6271922419170456`*^9, 
   3.6271933717488656`*^9, {3.6272140385557184`*^9, 3.6272140389657183`*^9}, {
   3.6307457311801405`*^9, 3.63074576712014*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6262899084163892`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.662981379946519*^9, 3.6645213017240744`*^9, 
  3.6645216713249617`*^9, 3.667656806798649*^9, 3.6726532617843657`*^9, 
  3.6726535619537654`*^9, 3.6726536072093654`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"8", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"76", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "76"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"52", ",", "17"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"51", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"101", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"50", ",", "75", ",", "100"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"50", ",", "75", ",", "8"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.662981379946519*^9, 3.6645213017240744`*^9, 
  3.6645216713249617`*^9, 3.667656806798649*^9, 3.6726532617843657`*^9, 
  3.6726535619537654`*^9, 3.672653607224965*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"inferTetraOrigin-Summary\"\>", "\<\"Genetic map of biallelic \
markers\"\>"},
     {"\<\"inferTetraOrigin-Summary\"\>", "\<\"MAP of parental \
haplotypes\"\>"},
     {"\<\"inferTetraOrigin-Summary\"\>", "\<\"Reference haplotypes\"\>"},
     {"\<\"inferTetraOrigin-Summary\"\>", "\<\"ln marginal likelihood of each \
valent of each sib\"\>"},
     {"\<\"inferTetraOrigin-Summary\"\>", "\<\"ln marginal likelihood given \
the LG type of each sib\"\>"},
     {"\<\"inferTetraOrigin-Summary\"\>", "\<\"Genotypes in order\"\>"},
     {"\<\"inferTetraOrigin-Summary\"\>", "\<\"Conditonal genotype \
probability\"\>"},
     {"\<\"inferTetraOrigin-Summary\"\>", "\<\"Conditonal haplotype \
probability\"\>"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.662981379946519*^9, 3.6645213017240744`*^9, 
  3.6645216713249617`*^9, 3.667656806798649*^9, 3.6726532617843657`*^9, 
  3.6726535619537654`*^9, 3.6726536072405653`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "take"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Cannot take positions \
\[NoBreak]\\!\\(\\*RowBox[{\\\"3\\\"}]\\)\[NoBreak] through \
\[NoBreak]\\!\\(\\*RowBox[{\\\"-\\\", \\\"1\\\"}]\\)\[NoBreak] in \
\[NoBreak]\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \\\"\\\\\\\"None\\\\\
\\\"\\\", \\\"}\\\"}], \\\"}\\\"}]\\)\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Part/take\\\", ButtonNote -> \
\\\"Part::take\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6726536072561655`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "1", ",", "2", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
      "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", 
      "2", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "2", ",", 
      "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "2", ",", 
      "2", ",", "2", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", 
      "1", ",", "2", ",", "1", ",", "2", ",", "1", ",", "2", ",", "2", ",", 
      "2", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", 
      "2", ",", "1", ",", "2", ",", "2", ",", "1", ",", "1", ",", "2", ",", 
      "2", ",", "1", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
      "2", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "2", ",", 
      "1", ",", "2", ",", "2", ",", "2", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", 
      "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "1", ",", "2", ",", 
      "2", ",", "1", ",", "2", ",", "2", ",", "2", ",", "1", ",", "1", ",", 
      "2", ",", "1", ",", "1", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
      "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "2", ",", 
      "2", ",", "1", ",", "2", ",", "1", ",", "1", ",", "2", ",", "1", ",", 
      "2", ",", "2", ",", "2", ",", "1", ",", "1", ",", "2", ",", "1", ",", 
      "2", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", 
      "1", ",", "2", ",", "2", ",", "1", ",", "1", ",", "2", ",", "1", ",", 
      "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", 
      "1", ",", "1", ",", "2", ",", "1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "2", ",", "1", ",", "2", ",", "1", ",", "1", ",", "2", ",", "2", ",", 
      "2", ",", "2", ",", "1", ",", "2", ",", "2", ",", "1", ",", "1", ",", 
      "2", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
      "2", ",", "2", ",", "2", ",", "1", ",", "1", ",", "2", ",", "1", ",", 
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "2", ",", 
      "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "2", ",", 
      "1", ",", "2", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
      "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "2", ",", "2", ",", 
      "2", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
      "2", ",", "2", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "2", ",", "2", ",", "1", ",", "2", ",", "1", ",", "2", ",", 
      "1", ",", "2", ",", "1", ",", "2", ",", "2", ",", "1", ",", "1", ",", 
      "1", ",", "1", ",", "1", ",", "2", ",", "2", ",", "1", ",", "2", ",", 
      "2", ",", "2", ",", "1", ",", "2", ",", "2", ",", "1", ",", "2", ",", 
      "2", ",", "2", ",", "1", ",", "1", ",", "2", ",", "2", ",", "1", ",", 
      "1", ",", "2", ",", "2", ",", "2", ",", "2", ",", "1", ",", "2", ",", 
      "1", ",", "2", ",", "2", ",", "2", ",", "2", ",", "1", ",", "1", ",", 
      "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "2", ",", 
      "1", ",", "1", ",", "2", ",", "2", ",", "1", ",", "1", ",", "2", ",", 
      "2", ",", "1", ",", "2", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
      "2", ",", "1", ",", "2", ",", "2", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
      "1", ",", "1", ",", "1", ",", "2", ",", "2", ",", "1", ",", "1", ",", 
      "1", ",", "1", ",", "2", ",", "2", ",", "1", ",", "2", ",", "2", ",", 
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", 
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "2", ",", 
      "2", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "2", ",", 
      "1", ",", "2", ",", "2", ",", "1", ",", "2", ",", "2", ",", "2", ",", 
      "1", ",", "2", ",", "1", ",", "1", ",", "2", ",", "2", ",", "2", ",", 
      "1", ",", "2", ",", "2", ",", "1", ",", "2", ",", "1", ",", "2", ",", 
      "1", ",", "2", ",", "2", ",", "2", ",", "1", ",", "1", ",", "2", ",", 
      "1", ",", "2", ",", "1", ",", "2", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "2", ",", "1", ",", "1", ",", "2", ",", "1", ",", "2", ",", "2", ",", 
      "2", ",", "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "2", ",", 
      "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", 
      "2", ",", "2", ",", "2", ",", "2", ",", "1", ",", "2", ",", "2", ",", 
      "2", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
      "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
      "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "2", ",", "2", ",", 
      "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "2", ",", 
      "2", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", 
      "1", ",", "2", ",", "2", ",", "1", ",", "2", ",", "2", ",", "2", ",", 
      "1", ",", "2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "2", ",", "2", ",", "1", ",", "1", ",", "2", ",", "2", ",", "2", ",", 
      "1", ",", "2", ",", "2", ",", "2", ",", "1", ",", "1", ",", "2", ",", 
      "2", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
      "1", ",", "2", ",", "1", ",", "2", ",", "1", ",", "2", ",", "1", ",", 
      "2", ",", "1", ",", "2", ",", "2", ",", "1", ",", "1", ",", "1", ",", 
      "1", ",", "2", ",", "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", 
      "1", ",", "2", ",", "2", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
      "2", ",", "1", ",", "2", ",", "2", ",", "1", ",", "1", ",", "2", ",", 
      "2", ",", "2", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
      "2", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
      "1", ",", "2", ",", "1", ",", "2", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "2", ",", "1", ",", "2", ",", "2", ",", "2", ",", "1", ",", "2", ",", 
      "1", ",", "2", ",", "2", ",", "2", ",", "1", ",", "2", ",", "1", ",", 
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
      "1", ",", "2", ",", "1", ",", "2", ",", "1", ",", "2", ",", "1", ",", 
      "2", ",", "1", ",", "2", ",", "2", ",", "1", ",", "2", ",", "2", ",", 
      "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "2", ",", 
      "1", ",", "2", ",", "1", ",", "2", ",", "2", ",", "1", ",", "1", ",", 
      "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", 
      "2", ",", "1", ",", "2", ",", 
      RowBox[{"esthaplo", "//", "MatrixForm2"}], ",", "2", ",", "1", ",", "1",
       ",", "1", ",", "2", ",", "2", ",", "2", ",", "2", ",", "1", ",", "1", 
      ",", "1", ",", "2", ",", "2", ",", "2", ",", "1"}], "}"}]}], "}"}], 
  "\[Equal]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", "\"\<None\>\"", "}"}], "}"}], "\[LeftDoubleBracket]", 
   RowBox[{
    RowBox[{"3", ";;", "All"}], ",", 
    RowBox[{"2", ";;", "All"}]}], "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.6726536190029655`*^9, 3.6726536190029655`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"esthaplo", "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"SNP\"\>", "\<\"SNP1\"\>", "\<\"SNP2\"\>", "\<\"SNP3\"\>", \
"\<\"SNP4\"\>", "\<\"SNP5\"\>", "\<\"SNP6\"\>", "\<\"SNP7\"\>", \
"\<\"SNP8\"\>", "\<\"SNP9\"\>", "\<\"SNP10\"\>", "\<\"SNP11\"\>", \
"\<\"SNP12\"\>", "\<\"SNP13\"\>", "\<\"SNP14\"\>", "\<\"SNP15\"\>", \
"\<\"SNP16\"\>", "\<\"SNP17\"\>", "\<\"SNP18\"\>", "\<\"SNP19\"\>", \
"\<\"SNP20\"\>", "\<\"SNP21\"\>", "\<\"SNP22\"\>", "\<\"SNP23\"\>", \
"\<\"SNP24\"\>", "\<\"SNP25\"\>", "\<\"SNP26\"\>", "\<\"SNP27\"\>", \
"\<\"SNP28\"\>", "\<\"SNP29\"\>", "\<\"SNP30\"\>", "\<\"SNP31\"\>", \
"\<\"SNP32\"\>", "\<\"SNP33\"\>", "\<\"SNP34\"\>", "\<\"SNP35\"\>", \
"\<\"SNP36\"\>", "\<\"SNP37\"\>", "\<\"SNP38\"\>", "\<\"SNP39\"\>", \
"\<\"SNP40\"\>", "\<\"SNP41\"\>", "\<\"SNP42\"\>", "\<\"SNP43\"\>", \
"\<\"SNP44\"\>", "\<\"SNP45\"\>", "\<\"SNP46\"\>", "\<\"SNP47\"\>", \
"\<\"SNP48\"\>", "\<\"SNP49\"\>", "\<\"SNP50\"\>", "\<\"SNP51\"\>", \
"\<\"SNP52\"\>", "\<\"SNP53\"\>", "\<\"SNP54\"\>", "\<\"SNP55\"\>", \
"\<\"SNP56\"\>", "\<\"SNP57\"\>", "\<\"SNP58\"\>", "\<\"SNP59\"\>", \
"\<\"SNP60\"\>", "\<\"SNP61\"\>", "\<\"SNP62\"\>", "\<\"SNP63\"\>", \
"\<\"SNP64\"\>", "\<\"SNP65\"\>", "\<\"SNP66\"\>", "\<\"SNP67\"\>", \
"\<\"SNP68\"\>", "\<\"SNP69\"\>", "\<\"SNP70\"\>", "\<\"SNP71\"\>", \
"\<\"SNP72\"\>", "\<\"SNP73\"\>", "\<\"SNP74\"\>", "\<\"SNP75\"\>"},
     {"\<\"Chromosome\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", \
"\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", \
"\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", \
"\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", \
"\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", \
"\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", \
"\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", \
"\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", \
"\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", \
"\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", \
"\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", \
"\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", \
"\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>", "\<\"A\"\>"},
     {"\<\"parent1_1\"\>", "1", "2", "1", "1", "2", "1", "1", "2", "1", "1", 
      "1", "1", "1", "2", "2", "1", "1", "2", "1", "1", "2", "1", "1", "1", 
      "2", "1", "1", "2", "2", "2", "1", "1", "1", "2", "1", "1", "2", "1", 
      "2", "1", "2", "2", "2", "1", "1", "2", "1", "1", "1", "2", "1", "2", 
      "2", "1", "1", "2", "2", "1", "2", "2", "2", "2", "2", "2", "1", "1", 
      "1", "2", "1", "2", "1", "2", "2", "2", "1"},
     {"\<\"parent1_2\"\>", "1", "1", "1", "1", "1", "1", "2", "2", "2", "2", 
      "2", "2", "1", "2", "2", "1", "2", "2", "2", "1", "1", "2", "1", "1", 
      "2", "2", "2", "2", "1", "1", "1", "1", "2", "1", "2", "2", "1", "2", 
      "1", "1", "2", "1", "2", "2", "2", "1", "1", "2", "1", "2", "1", "1", 
      "2", "1", "1", "1", "1", "2", "2", "1", "1", "2", "1", "1", "2", "1", 
      "1", "1", "1", "2", "1", "1", "2", "1", "2"},
     {"\<\"parent1_3\"\>", "2", "1", "2", "1", "1", "2", "2", "2", "2", "1", 
      "2", "2", "1", "1", "2", "1", "1", "1", "2", "1", "1", "2", "2", "2", 
      "1", "1", "2", "1", "1", "1", "1", "1", "1", "2", "2", "1", "1", "1", 
      "1", "2", "1", "1", "1", "1", "1", "1", "1", "2", "2", "1", "2", "1", 
      "1", "2", "1", "1", "1", "2", "1", "1", "1", "2", "2", "2", "1", "1", 
      "1", "2", "1", "1", "2", "2", "1", "2", "1"},
     {"\<\"parent1_4\"\>", "1", "2", "2", "1", "2", "1", "2", "1", "2", "1", 
      "2", "2", "1", "1", "1", "1", "1", "2", "2", "1", "2", "2", "2", "1", 
      "2", "2", "1", "2", "2", "2", "1", "1", "2", "2", "1", "1", "2", "2", 
      "2", "2", "1", "2", "1", "2", "2", "2", "2", "1", "1", "1", "1", "2", 
      "1", "1", "1", "2", "1", "1", "2", "2", "1", "1", "2", "2", "1", "2", 
      "1", "2", "1", "1", "2", "1", "2", "2", "1"},
     {"\<\"parent2_1\"\>", "1", "1", "2", "1", "1", "1", "1", "1", "1", "1", 
      "2", "2", "1", "1", "1", "1", "2", "2", "1", "2", "2", "1", "1", "1", 
      "1", "1", "1", "2", "1", "1", "1", "1", "1", "2", "2", "2", "1", "1", 
      "2", "1", "1", "2", "1", "2", "2", "1", "2", "2", "2", "1", "2", "1", 
      "1", "2", "2", "2", "1", "2", "2", "1", "2", "1", "2", "1", "2", "2", 
      "2", "1", "1", "2", "1", "2", "1", "2", "2"},
     {"\<\"parent2_2\"\>", "2", "1", "1", "2", "1", "2", "2", "2", "1", "2", 
      "1", "1", "1", "2", "2", "1", "1", "1", "1", "2", "1", "2", "2", "2", 
      "2", "1", "2", "2", "2", "2", "1", "1", "1", "1", "1", "1", "2", "1", 
      "1", "1", "1", "1", "1", "1", "1", "2", "1", "2", "2", "1", "1", "1", 
      "1", "2", "1", "2", "2", "2", "1", "1", "1", "1", "2", "1", "2", "2", 
      "1", "2", "2", "2", "1", "2", "2", "2", "2"},
     {"\<\"parent2_3\"\>", "2", "2", "1", "1", "2", "2", "2", "1", "2", "2", 
      "2", "1", "1", "2", "2", "2", "1", "1", "1", "1", "1", "1", "2", "1", 
      "2", "1", "2", "1", "2", "1", "2", "2", "1", "1", "1", "1", "2", "1", 
      "2", "1", "1", "1", "1", "2", "2", "1", "2", "1", "1", "2", "1", "2", 
      "2", "1", "1", "2", "2", "2", "1", "1", "2", "1", "1", "2", "1", "1", 
      "1", "2", "1", "1", "1", "2", "1", "2", "2"},
     {"\<\"parent2_4\"\>", "2", "1", "2", "2", "2", "1", "2", "1", "2", "2", 
      "2", "1", "2", "1", "1", "1", "1", "1", "1", "1", "1", "1", "2", "1", 
      "2", "1", "2", "1", "2", "1", "2", "2", "1", "2", "2", "1", "1", "1", 
      "2", "1", "1", "2", "1", "2", "1", "2", "2", "1", "1", "1", "2", "1", 
      "1", "1", "2", "1", "2", "1", "2", "2", "2", "1", "1", "1", "2", "2", 
      "2", "2", "1", "1", "1", "2", "2", "2", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6726536244473653`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"esthaplo", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6726535678505654`*^9, 3.6726535711577654`*^9}}],

Cell[BoxData[
 RowBox[{"old", "=", 
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"\"\<SNP\>\"", "\"\<SNP1\>\"", "\"\<SNP2\>\"", "\"\<SNP3\>\"", 
       "\"\<SNP4\>\"", "\"\<SNP5\>\"", "\"\<SNP6\>\"", "\"\<SNP7\>\"", 
       "\"\<SNP8\>\"", "\"\<SNP9\>\"", "\"\<SNP10\>\"", "\"\<SNP11\>\"", 
       "\"\<SNP12\>\"", "\"\<SNP13\>\"", "\"\<SNP14\>\"", "\"\<SNP15\>\"", 
       "\"\<SNP16\>\"", "\"\<SNP17\>\"", "\"\<SNP18\>\"", "\"\<SNP19\>\"", 
       "\"\<SNP20\>\"", "\"\<SNP21\>\"", "\"\<SNP22\>\"", "\"\<SNP23\>\"", 
       "\"\<SNP24\>\"", "\"\<SNP25\>\"", "\"\<SNP26\>\"", "\"\<SNP27\>\"", 
       "\"\<SNP28\>\"", "\"\<SNP29\>\"", "\"\<SNP30\>\"", "\"\<SNP31\>\"", 
       "\"\<SNP32\>\"", "\"\<SNP33\>\"", "\"\<SNP34\>\"", "\"\<SNP35\>\"", 
       "\"\<SNP36\>\"", "\"\<SNP37\>\"", "\"\<SNP38\>\"", "\"\<SNP39\>\"", 
       "\"\<SNP40\>\"", "\"\<SNP41\>\"", "\"\<SNP42\>\"", "\"\<SNP43\>\"", 
       "\"\<SNP44\>\"", "\"\<SNP45\>\"", "\"\<SNP46\>\"", "\"\<SNP47\>\"", 
       "\"\<SNP48\>\"", "\"\<SNP49\>\"", "\"\<SNP50\>\"", "\"\<SNP51\>\"", 
       "\"\<SNP52\>\"", "\"\<SNP53\>\"", "\"\<SNP54\>\"", "\"\<SNP55\>\"", 
       "\"\<SNP56\>\"", "\"\<SNP57\>\"", "\"\<SNP58\>\"", "\"\<SNP59\>\"", 
       "\"\<SNP60\>\"", "\"\<SNP61\>\"", "\"\<SNP62\>\"", "\"\<SNP63\>\"", 
       "\"\<SNP64\>\"", "\"\<SNP65\>\"", "\"\<SNP66\>\"", "\"\<SNP67\>\"", 
       "\"\<SNP68\>\"", "\"\<SNP69\>\"", "\"\<SNP70\>\"", "\"\<SNP71\>\"", 
       "\"\<SNP72\>\"", "\"\<SNP73\>\"", "\"\<SNP74\>\"", "\"\<SNP75\>\""},
      {"\"\<Chromosome\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", 
       "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", 
       "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", 
       "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", 
       "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", 
       "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", 
       "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", 
       "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", 
       "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", 
       "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", 
       "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", 
       "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", 
       "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", 
       "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", 
       "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", "\"\<A\>\"", 
       "\"\<A\>\"", "\"\<A\>\""},
      {"\"\<parent1_1\>\"", "2", "1", "2", "1", "1", "2", "2", "2", "2", "1", 
       "2", "2", "1", "1", "2", "1", "1", "1", "2", "1", "1", "2", "2", "2", 
       "1", "1", "2", "1", "1", "1", "1", "1", "1", "2", "2", "1", "1", "1", 
       "1", "2", "1", "1", "1", "1", "1", "1", "1", "2", "2", "1", "2", "1", 
       "1", "2", "1", "1", "1", "2", "1", "1", "1", "2", "2", "2", "1", "1", 
       "1", "2", "1", "1", "2", "2", "1", "2", "1"},
      {"\"\<parent1_2\>\"", "1", "2", "2", "1", "2", "1", "2", "1", "2", "1", 
       "2", "2", "1", "1", "1", "1", "1", "2", "2", "1", "2", "2", "2", "1", 
       "2", "2", "1", "2", "2", "2", "1", "1", "2", "2", "1", "1", "2", "2", 
       "2", "2", "1", "2", "1", "2", "2", "2", "2", "1", "1", "1", "1", "2", 
       "1", "1", "1", "2", "1", "1", "2", "2", "1", "1", "2", "2", "1", "2", 
       "1", "2", "1", "1", "2", "1", "2", "2", "1"},
      {"\"\<parent1_3\>\"", "1", "1", "1", "1", "1", "1", "2", "2", "2", "2", 
       "2", "2", "1", "2", "2", "1", "2", "2", "2", "1", "1", "2", "1", "1", 
       "2", "2", "2", "2", "1", "1", "1", "1", "2", "1", "2", "2", "1", "2", 
       "1", "1", "2", "1", "2", "2", "2", "1", "1", "2", "1", "2", "1", "1", 
       "2", "1", "1", "1", "1", "2", "2", "1", "1", "2", "1", "1", "2", "1", 
       "1", "1", "1", "2", "1", "1", "2", "1", "2"},
      {"\"\<parent1_4\>\"", "1", "2", "1", "1", "2", "1", "1", "2", "1", "1", 
       "1", "1", "1", "2", "2", "1", "1", "2", "1", "1", "2", "1", "1", "1", 
       "2", "1", "1", "2", "2", "2", "1", "1", "1", "2", "1", "1", "2", "1", 
       "2", "1", "2", "2", "2", "1", "1", "2", "1", "1", "1", "2", "1", "2", 
       "2", "1", "1", "2", "2", "1", "2", "2", "2", "2", "2", "2", "1", "1", 
       "1", "2", "1", "2", "1", "2", "2", "2", "1"},
      {"\"\<parent2_1\>\"", "2", "2", "1", "1", "2", "2", "2", "1", "2", "2", 
       "2", "1", "1", "2", "2", "2", "1", "1", "1", "1", "1", "1", "2", "1", 
       "2", "1", "2", "1", "2", "1", "2", "2", "1", "1", "1", "1", "2", "1", 
       "2", "1", "1", "1", "1", "2", "2", "1", "2", "1", "1", "2", "1", "2", 
       "2", "1", "1", "2", "2", "2", "1", "1", "2", "1", "1", "2", "1", "1", 
       "1", "2", "1", "1", "1", "2", "1", "2", "2"},
      {"\"\<parent2_2\>\"", "2", "1", "2", "2", "2", "1", "2", "1", "2", "2", 
       "2", "1", "2", "1", "1", "1", "1", "1", "1", "1", "1", "1", "2", "1", 
       "2", "1", "2", "1", "2", "1", "2", "2", "1", "2", "2", "1", "1", "1", 
       "2", "1", "1", "2", "1", "2", "1", "2", "2", "1", "1", "1", "2", "1", 
       "1", "1", "2", "1", "2", "1", "2", "2", "2", "1", "1", "1", "2", "2", 
       "2", "2", "1", "1", "1", "2", "2", "2", "1"},
      {"\"\<parent2_3\>\"", "1", "1", "2", "1", "1", "1", "1", "1", "1", "1", 
       "2", "2", "1", "1", "1", "1", "2", "2", "1", "2", "2", "1", "1", "1", 
       "1", "1", "1", "2", "1", "1", "1", "1", "1", "2", "2", "2", "1", "1", 
       "2", "1", "1", "2", "1", "2", "2", "1", "2", "2", "2", "1", "2", "1", 
       "1", "2", "2", "2", "1", "2", "2", "1", "2", "1", "2", "1", "2", "2", 
       "2", "1", "1", "2", "1", "2", "1", "2", "2"},
      {"\"\<parent2_4\>\"", "2", "1", "1", "2", "1", "2", "2", "2", "1", "2", 
       "1", "1", "1", "2", "2", "1", "1", "1", "1", "2", "1", "2", "2", "2", 
       "2", "1", "2", "2", "2", "2", "1", "1", "1", "1", "1", "1", "2", "1", 
       "1", "1", "1", "1", "1", "1", "1", "2", "1", "2", "2", "1", "1", "1", 
       "1", "2", "1", "2", "2", "2", "1", "1", "1", "1", "2", "1", "2", "2", 
       "1", "2", "2", "2", "1", "2", "2", "2", "2"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]]}]], "Input",
 CellChangeTimes->{{3.6726536445089655`*^9, 3.6726536456789656`*^9}, {
  3.6726537174857655`*^9, 3.672653719576165*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"esthaplo", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"3", ";;"}], ",", 
       RowBox[{"2", ";;"}]}], "]"}], "]"}], "-", 
    RowBox[{"old", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"3", ";;"}], ",", 
       RowBox[{"2", ";;"}]}], "]"}], "]"}]}], "//", "MatrixForm"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6726537233045654`*^9, 3.6726537377511654`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], "0", "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "1", "0", "0", "0", "1", 
      RowBox[{"-", "1"}], "0", "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", "0", 
      RowBox[{"-", "1"}], "1", "1", "1", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "1", "0", "1", 
      RowBox[{"-", "1"}], "1", "1", "1", "0", "0", "1", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], "1", "1", 
      RowBox[{"-", "1"}], "0", "1", "1", 
      RowBox[{"-", "1"}], "1", "1", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1", 
      RowBox[{"-", "1"}], "0", "1", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "1", "0", "1", "0", "0", "0", "1", "1", 
      "0", "1", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "1", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "0", "0", 
      RowBox[{"-", "1"}], "1", "1", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], "1", "0", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", "0", "1", "0", 
      RowBox[{"-", "1"}], "1", "0", "0", 
      RowBox[{"-", "1"}], "0", "1", "0", 
      RowBox[{"-", "1"}], "0", "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "1", 
      RowBox[{"-", "1"}], "0", "0", 
      RowBox[{"-", "1"}], "1"},
     {"1", "0", "1", "0", "0", "1", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "1", "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "1", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "1", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "0", "0", "1", 
      RowBox[{"-", "1"}], "1", "0", 
      RowBox[{"-", "1"}], "1", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "1", "1", 
      RowBox[{"-", "1"}], "0", "0", "1", "0", 
      RowBox[{"-", "1"}], "1", "1", 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}]},
     {"0", "0", "1", "0", "0", "0", "1", 
      RowBox[{"-", "1"}], "1", "0", "1", "1", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "0", "0", "1", "0", "0", "1", "1", "0", "0", 
      "1", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "1", "0", 
      "1", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "1", "1", "0", "1", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "0", "0", "1", "0", "0", "0", 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], "0", "0", "0"},
     {
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "1", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", "1", "0", "1", "1", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "1", "1", "1", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "1", "1", 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", "1", "0", 
      RowBox[{"-", "1"}], "0", "1", "0", "0", "0", "1", 
      RowBox[{"-", "1"}], "1", "1", "1", 
      RowBox[{"-", "1"}], "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "1", "0", "1", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "1", "1", "0", "0", "0", "0", "1", "0", "1", "0", 
      "1", "0", "0", "0", "1", "0", "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "1", "0", 
      RowBox[{"-", "1"}], "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", 
      RowBox[{"-", "1"}], "1", "1", "0", 
      RowBox[{"-", "1"}], "0", "0", "1", 
      RowBox[{"-", "1"}], "1", "0", "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "1", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "1", "1", "0", "0", "0", "0", "1"},
     {"1", "1", 
      RowBox[{"-", "1"}], "0", "1", "1", "1", "0", "1", "1", "0", 
      RowBox[{"-", "1"}], "0", "1", "1", "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "1", "0", "1", "0", "1", 
      RowBox[{"-", "1"}], "1", "0", "1", "1", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], "1", "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "1", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "1", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "1", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "1", "0", "1", "0", "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "1", "1", "0", "1", "1", "0", 
      RowBox[{"-", "1"}], "0", "1", "0", "0", "1", "0", "1", "0", "0", "1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "1", "0", "0", 
      RowBox[{"-", "1"}], "1", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "1", "1", "1", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "1", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6726537254729652`*^9, 3.6726538489323654`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{
   RowBox[{"esthaplo", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"3", ";;"}], ",", 
      RowBox[{"2", ";;"}]}], "]"}], "]"}], "-", 
   RowBox[{"old", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"3", ";;"}], ",", 
      RowBox[{"2", ";;"}]}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6726536406869655`*^9, 3.6726537102317657`*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJzdWqFOA0EQvQSDJAFPSFD8Aeokog5VfQkaj8TwLzSpIhh+AFlMRVH1Ff0E
SlCIS3d23sx7e00u0zTb3bdvZt/O3uzV8Hj/cNJ13enhmR2e3+9/n31vtdun
i+XddtN3/z7l7W8un1+/Fqt+OJvfvn2u++/z6/ePl93o/4+19+JB4bfOC2XR
fHrbs/GP+RcVJ6X91PJmxYnqJ2pc9Hrx4rTGDzs+o+PNar14VHWylH903E5V
r7x8otZdls5E50Uq8VDLM2p/KbUsnUHxOcZbtI5Frxd2PunlARXnavGJ5tna
Xu1cicKfrXu147LOC1F4Ws8rUPrAOu9Hrxe0fmbnY+h9p3TcWn5Q/KvrJGvf
n6peoflUOQdltY/Kc9TO+8fGRVmWzljxePcj1rpT26dQfFp/V+Uh2rbiRyv+
Vt57R9ePWPUpllXJS63tVd9vRNfvsvtR6781nbHyxsonVerpqPm0Ev/sOB+z
KvXN6Hmy6h2o/Dn6vMzSnyy/TLVuy3pfEe2XqPcGVpxsfWulnqWCk+0v73xZ
+sy6V8a+T+Llh3WvmzXfLPyl/WfFTzZ+tL+y91O0v7z8t1KPVuOfnZ+r1NlZ
929VeYvOZ7Lvi9bOtxV/qVmVOuMPcp6wkQ==
   "], {{0, 0}, {75, 8}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{7.5, 
       FormBox["1", TraditionalForm]}, {6.5, 
       FormBox["2", TraditionalForm]}, {5.5, 
       FormBox["3", TraditionalForm]}, {4.5, 
       FormBox["4", TraditionalForm]}, {3.5, 
       FormBox["5", TraditionalForm]}, {2.5, 
       FormBox["6", TraditionalForm]}, {1.5, 
       FormBox["7", TraditionalForm]}, {0.5, 
       FormBox["8", TraditionalForm]}}, {{7.5, 
       FormBox["1", TraditionalForm]}, {6.5, 
       FormBox["2", TraditionalForm]}, {5.5, 
       FormBox["3", TraditionalForm]}, {4.5, 
       FormBox["4", TraditionalForm]}, {3.5, 
       FormBox["5", TraditionalForm]}, {2.5, 
       FormBox["6", TraditionalForm]}, {1.5, 
       FormBox["7", TraditionalForm]}, {0.5, 
       FormBox["8", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {39.5, 
       FormBox["40", TraditionalForm]}, {59.5, 
       FormBox["60", TraditionalForm]}, {74.5, 
       FormBox["75", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {39.5, 
       FormBox["40", TraditionalForm]}, {59.5, 
       FormBox["60", TraditionalForm]}, {74.5, 
       FormBox["75", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->{574.3999999999996, Automatic},
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05]}]], "Output",
 CellChangeTimes->{{3.672653668205365*^9, 3.6726537107777653`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**"}], "*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**"}], "*", 
   RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}],
    "*", "*", "**"}], "******)"}]], "Input",
 CellChangeTimes->{{3.6214025021356735`*^9, 3.6214025084166737`*^9}}]
},
WindowSize->{1280, 924},
WindowMargins->{{-9, Automatic}, {Automatic, -9}},
ShowSelection->True,
Magnification:>1.25 Inherited,
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (December 10, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info-ae0a2cb4-a547-4811-b239-858c35d96cdf"->{
  Cell[6487, 165, 930, 14, 149, "Print",
   CellTags->"Info-ae0a2cb4-a547-4811-b239-858c35d96cdf"],
  Cell[7420, 181, 1422, 36, 90, "Print",
   CellTags->"Info-ae0a2cb4-a547-4811-b239-858c35d96cdf"]},
 "Info-13a38cde-892c-44f5-9d92-8ee02e570cbc"->{
  Cell[16813, 423, 458, 7, 77, "Print",
   CellTags->"Info-13a38cde-892c-44f5-9d92-8ee02e570cbc"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info-ae0a2cb4-a547-4811-b239-858c35d96cdf", 54251, 1189},
 {"Info-13a38cde-892c-44f5-9d92-8ee02e570cbc", 54500, 1194}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 927, 16, 83, "Input"],
Cell[1509, 40, 324, 4, 36, "Output"]
}, Open  ]],
Cell[1848, 47, 1217, 30, 175, "Input"],
Cell[CellGroupData[{
Cell[3090, 81, 649, 15, 83, "Input"],
Cell[3742, 98, 239, 5, 36, "Output"],
Cell[3984, 105, 1715, 34, 236, "Output"]
}, Open  ]],
Cell[5714, 142, 565, 12, 60, "Input"],
Cell[CellGroupData[{
Cell[6304, 158, 158, 3, 36, "Input"],
Cell[CellGroupData[{
Cell[6487, 165, 930, 14, 149, "Print",
 CellTags->"Info-ae0a2cb4-a547-4811-b239-858c35d96cdf"],
Cell[7420, 181, 1422, 36, 90, "Print",
 CellTags->"Info-ae0a2cb4-a547-4811-b239-858c35d96cdf"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8891, 223, 844, 15, 60, "Input"],
Cell[CellGroupData[{
Cell[9760, 242, 503, 11, 27, "Print"],
Cell[10266, 255, 950, 22, 50, "Print"],
Cell[11219, 279, 595, 13, 27, "Print"],
Cell[11817, 294, 599, 12, 27, "Print"],
Cell[12419, 308, 284, 4, 27, "Print"]
}, Open  ]]
}, Open  ]],
Cell[12730, 316, 565, 12, 60, "Input"],
Cell[CellGroupData[{
Cell[13320, 332, 628, 15, 83, "Input"],
Cell[13951, 349, 154, 2, 36, "Output"],
Cell[14108, 353, 162, 2, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14307, 360, 146, 2, 36, "Input"],
Cell[14456, 364, 101, 1, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14594, 370, 946, 18, 106, "Input"],
Cell[15543, 390, 248, 3, 36, "Output"],
Cell[15794, 395, 285, 5, 36, "Output"]
}, Open  ]],
Cell[16094, 403, 565, 12, 60, "Input"],
Cell[CellGroupData[{
Cell[16684, 419, 126, 2, 36, "Input"],
Cell[16813, 423, 458, 7, 77, "Print",
 CellTags->"Info-13a38cde-892c-44f5-9d92-8ee02e570cbc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17308, 435, 1335, 34, 129, "Input"],
Cell[18646, 471, 284, 5, 36, "Output"],
Cell[18933, 478, 806, 23, 36, "Output"],
Cell[19742, 503, 1453, 32, 198, "Output"],
Cell[21198, 537, 654, 13, 29, "Message"]
}, Open  ]],
Cell[21867, 553, 7344, 116, 405, InheritFromParent],
Cell[CellGroupData[{
Cell[29236, 673, 66, 1, 36, "Input"],
Cell[29305, 676, 6451, 96, 230, "Output"]
}, Open  ]],
Cell[35771, 775, 136, 2, 36, "Input"],
Cell[35910, 779, 6820, 101, 221, InheritFromParent],
Cell[CellGroupData[{
Cell[42755, 884, 463, 15, 60, "Input"],
Cell[43221, 901, 7215, 189, 190, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50473, 1095, 417, 13, 36, "Input"],
Cell[50893, 1110, 2392, 50, 156, "Output"]
}, Open  ]],
Cell[53300, 1163, 565, 12, 60, "Input"]
}
]
*)

(* End of internal cache information *)
